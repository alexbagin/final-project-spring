<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Личный кабинет администратора</title>
    <link th:href="@{/css/style.css}" type="text/css" rel="stylesheet">
    <style>
        body {
            font-family: "Malgun Gothic";
            background-color: aliceblue;
        }
    </style>
</head>
<body>
<h2>Личный кабинет администратора</h2>
<form method="POST" th:action="@{/logout}">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
    <button style="font-size: 15px" type="submit">Выйти из личного кабинета</button>
</form><br>
<fieldset style="background-color: white; border-radius: 20px;"><legend style="font-weight: bold;">Работа с пользвателями</legend>
    <table>
        <tr><th>Логин</th><th>Имя</th><th>Роль в системе</th><th>Телефон</th></tr>
        <div th:each="user : ${users}">
            <tr>
                <td th:text="${user.getLogin()}"></td>
                <td th:text="${user.getUsername()}"></td>
                <td th:text="${user.getRole()}"></td>
                <td th:text="${user.getTelephone()}"></td>
                <td><form th:action="@{/admin/edit_person/{id}(id=${user.getId()})}"><button type="submit" th:name="action" value="Изменить роль">Изменить роль</button></form></td>
                <td><form th:action="@{/admin/view_orders/{id}(id=${user.getId()})}"><button type="submit" th:name="action" value="История заказов">История заказов</button></form></td>
            </tr>
        </div>
    </table>
</fieldset><br>
<fieldset style="background-color: white; border-radius: 20px;"><legend style="font-weight: bold;">Поиск заказа</legend>
    <form th:method="POST" th:action="@{/admin/view_orders/search_order}">
        <label for="search_order">Укажите последние символы заказа:</label>
        <input type="text" th:name="search_order" th:value="${search_order}" id="search_order">
        <input type="submit" value="Найти">
    </form>
    <h4>Результат поиска:</h4>
    <table>
        <tr><th>Номер заказа</th><th>Статус</th><th>Дата</th><th>Стоимость</th><th>Клиент</th></tr>
        <div th:each="ord : ${orders_find}">
            <tr>
                <td th:text="${ord.getNumber()}"></td>
                <td th:text="${ord.getStatus()}"></td>
                <td th:text="${#temporals.format(ord.getDateTime(),'dd-MM-yyyy')}"></td>
                <td th:text="${ord.getPrice()} + ' руб.'"></td>
                <td th:text="${ord.getPerson().getUsername()}"></td>
            </tr>
        </div>
    </table>
</fieldset><br>
<fieldset style="background-color: white; border-radius: 20px;"><legend style="font-weight: bold;">Работа с заказами</legend>
    <table>
        <tr><th>Номер заказа</th><th>Статус</th><th>Дата</th><th>Стоимость</th></tr>
        <div th:each="order : ${orders}">
            <tr>
                <form th:method="POST" th:action="@{/admin/view_orders/{id}(id=${order.getPerson().getId()})}">
                    <td hidden="hidden"><input type="text" readonly th:name="order_id" id="order_id" th:value="${order.getId()}" hidden="hidden"></td>
                    <td><input type="text" readonly style="width: 250px" th:name="order_number" id="order_number" th:value="${order.getNumber()}"></td>
                    <td>
                        <select th:name="status">
                            <option th:each="i : ${status}" th:value="${i}" th:text="${i}" th:selected="${i==order.getStatus()}"></option>
                        </select>
                    </td>
                    <td><input type="text" readonly th:value="${#temporals.format(order.getDateTime(),'dd-MM-yyyy')}"></td>
                    <td><input type="text" readonly th:value="${order.getPrice()} + ' руб.'"></td>
                    <td>
                        <a style="text-decoration: none; color: indianred;" th:href="@{admin/view_orders/admin/delete_order/{idOrder}(idOrder=${order.getId()})}">Удалить</a>
                    </td>
                    <td><input type="submit" value="Сохранить"></td>
                </form>
            </tr>
        </div>
    </table>
</fieldset>
<h3 style="text-align: center;" >Работа с товарами</h3>
<div style="text-align: center">
    <a style="text-decoration: none; color: royalblue; text-align: center; font-size: 20px;" th:href="@{admin/product/add}">Добавить товар</a>
</div>
<div style="display: grid; grid-template-columns: repeat(3,1fr);">
    <div style="margin-top: 10px; margin-left: auto; margin-right: auto; width: 500px; padding: 15px; border: 2px solid darkseagreen; border-radius:20px; background-color: white;" th:each="product : ${products}">
        <p style="text-decoration: underline; text-align: center; font-weight: bold;" th:text="${product.getTitle()}"></p>
        <img style="display: block; margin-left: auto; margin-right: auto;" th:src="'/img/' + ${product.imageList[0].getFileName()}" width="100px">
        <p th:text="'Описание: ' + ${product.getDescription()}"></p>
        <p th:text="'Цена: ' + ${product.getPrice()} + ' руб.'"></p>
        <p th:text="'Cклад: ' + ${product.getWarehouse()}"></p>
        <p th:text="'Продавец: ' + ${product.getSeller()}"></p>
        <p th:text="'Категория: ' + ${product.getCategory().getName()}"></p>
        <div style="text-align: center; padding: 5px;">
            <a style="text-decoration: none; color: royalblue;" th:href="@{/admin/product/edit/{id}(id=${product.getId()})}">Редактирование товара</a><br><br>
        </div>
        <div style="text-align: center; padding: 5px;">
            <a style="text-decoration: none; color: indianred;" th:href="@{/admin/product/delete/{id}(id=${product.getId()})}">Удаление товара</a>
        </div>
    </div>
</div>
</body>
</html>